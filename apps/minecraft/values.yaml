app-template:
  controllers:
    minecraft:
      pod:
        securityContext:
          fsGroup: 1000
          runAsUser: 1000
          runAsGroup: 1000
      containers:
        app:
          probes:
            liveness:
              enabled: false
            readiness:
              enabled: false
            startup:
              enabled: false
          image:
            repository: gameservermanagers/gameserver
            tag: mc
          resources:
            requests:
              cpu: 10m
              memory: 983Mi
            limits:
              memory: 983Mi
  configMaps:
    config:
      enabled: true
      data:
        common.cfg: |
          ##################################
          ######## Common Settings #########
          ##################################
          # PLACE GLOBAL SETTINGS HERE
          ## These settings will apply to all instances.

          #### Game Server Settings ####
          javaram="1024"
          mcversion="1.13.2"
          branch="release"
        server.properties: |
          # Minecraft Server Properties
          gamemode=survival
          motd=LinuxGSM
          white-list=true
          spawn-protection=0
          difficulty=normal
  service:
    app:
      controller: minecraft
      ports:
        http:
          port: 25565
  ingress:
    main:
      enabled: true
      className: nginx
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
        external-dns.alpha.kubernetes.io/target: "homelab-tunnel.meyeringh.org"
        external-dns.alpha.kubernetes.io/cloudflare-proxied: "true"
      hosts:
        - host: &host minecraft.meyeringh.org
          paths:
            - path: /
              pathType: Prefix
              service:
                identifier: app
                port: 25565
      tls:
        - hosts:
            - *host
          secretName: minecraft-tls-certificate
  persistence:
    data:
      enabled: true
      accessMode: ReadWriteOnce
      size: 5Gi
      retain: true
      advancedMounts:
        minecraft:
          app:
            - path: /data
              subPath: data
    common-cfg:
      enabled: true
      type: configMap
      identifier: config
      globalMounts:
        - path: /data/config-lgsm/mcserver/common.cfg
          subPath: common.cfg
    server-properties:
      enabled: true
      type: configMap
      identifier: config
      globalMounts:
        - path: /data/serverfiles/server.properties
          subPath: server.properties
    drive:
      enabled: true
      existingClaim: my-files-pvc
      advancedMounts:
        minecraft:
          app:
            - path: /my-files
